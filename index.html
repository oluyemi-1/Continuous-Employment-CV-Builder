<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Continuous Employment CV Builder</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Icon components
        const Plus = (props) => (
            <svg {...props} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
        );
        
        const Trash2 = (props) => (
            <svg {...props} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                <line x1="10" y1="11" x2="10" y2="17"></line>
                <line x1="14" y1="11" x2="14" y2="17"></line>
            </svg>
        );
        
        const Download = (props) => (
            <svg {...props} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
        );
        
        const AlertCircle = (props) => (
            <svg {...props} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="12"></line>
                <line x1="12" y1="16" x2="12.01" y2="16"></line>
            </svg>
        );

        function CVBuilder() {
          const [personalInfo, setPersonalInfo] = useState({
            fullName: '',
            email: '',
            phone: '',
            dateOfBirth: '',
            currentAge: ''
          });

          const [entries, setEntries] = useState([]);
          const [gaps, setGaps] = useState([]);

          const calculateAge = (dob) => {
            if (!dob) return '';
            const today = new Date();
            const birthDate = new Date(dob);
            let age = today.getFullYear() - birthDate.getFullYear();
            const m = today.getMonth() - birthDate.getMonth();
            if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
              age--;
            }
            return age;
          };

          const handleDOBChange = (dob) => {
            const age = calculateAge(dob);
            setPersonalInfo({ ...personalInfo, dateOfBirth: dob, currentAge: age });
          };

          const addEntry = () => {
            setEntries([...entries, {
              id: Date.now(),
              type: 'employment',
              title: '',
              company: '',
              location: '',
              startDate: '',
              endDate: '',
              isCurrent: false,
              description: ''
            }]);
          };

          const updateEntry = (id, field, value) => {
            setEntries(entries.map(entry => {
              if (entry.id === id) {
                if (field === 'isCurrent') {
                  return { ...entry, isCurrent: value, endDate: value ? '' : entry.endDate };
                }
                return { ...entry, [field]: value };
              }
              return entry;
            }));
          };

          const deleteEntry = (id) => {
            setEntries(entries.filter(entry => entry.id !== id));
          };

          const checkForGaps = () => {
            if (!personalInfo.dateOfBirth || entries.length === 0) return;

            const startDate = new Date(personalInfo.dateOfBirth);
            startDate.setFullYear(startDate.getFullYear() + 16);

            const sortedEntries = [...entries].sort((a, b) => 
              new Date(a.startDate) - new Date(b.startDate)
            );

            const foundGaps = [];
            let currentDate = startDate;

            sortedEntries.forEach((entry) => {
              const entryStart = new Date(entry.startDate);
              
              if (entryStart > currentDate) {
                const gapDays = Math.floor((entryStart - currentDate) / (1000 * 60 * 60 * 24));
                if (gapDays > 0) {
                  foundGaps.push({
                    start: currentDate.toISOString().split('T')[0],
                    end: new Date(entryStart.getTime() - 86400000).toISOString().split('T')[0],
                    days: gapDays
                  });
                }
              }

              currentDate = entry.isCurrent ? new Date() : new Date(entry.endDate);
              currentDate.setDate(currentDate.getDate() + 1);
            });

            const today = new Date();
            if (currentDate < today) {
              const gapDays = Math.floor((today - currentDate) / (1000 * 60 * 60 * 24));
              if (gapDays > 0) {
                foundGaps.push({
                  start: currentDate.toISOString().split('T')[0],
                  end: today.toISOString().split('T')[0],
                  days: gapDays
                });
              }
            }

            setGaps(foundGaps);
          };

          const generatePDF = () => {
            checkForGaps();
            
            if (gaps.length > 0) {
              alert('Please fill all employment gaps before downloading your CV');
              return;
            }

            const sortedEntries = [...entries].sort((a, b) => 
              new Date(b.startDate) - new Date(a.startDate)
            );

            const printWindow = window.open('', '_blank');
            
            let content = `
              <!DOCTYPE html>
              <html>
                <head>
                  <meta charset="UTF-8">
                  <title>${personalInfo.fullName} - CV</title>
                  <style>
                    @page {
                      size: A4;
                      margin: 20mm;
                    }
                    
                    * {
                      margin: 0;
                      padding: 0;
                      box-sizing: border-box;
                    }
                    
                    body { 
                      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                      line-height: 1.6;
                      color: #333;
                      background: white;
                      padding: 20px;
                    }
                    
                    .container {
                      max-width: 800px;
                      margin: 0 auto;
                    }
                    
                    h1 { 
                      color: #2563eb;
                      font-size: 32px;
                      border-bottom: 4px solid #2563eb;
                      padding-bottom: 12px;
                      margin-bottom: 20px;
                    }
                    
                    h2 { 
                      color: #1e40af;
                      font-size: 24px;
                      margin-top: 30px;
                      margin-bottom: 20px;
                      border-bottom: 2px solid #e5e7eb;
                      padding-bottom: 8px;
                    }
                    
                    .personal-info { 
                      margin-bottom: 30px;
                      background: #f8fafc;
                      padding: 20px;
                      border-radius: 8px;
                      border-left: 4px solid #2563eb;
                    }
                    
                    .personal-info p {
                      margin-bottom: 8px;
                      font-size: 14px;
                    }
                    
                    .personal-info strong {
                      color: #1e40af;
                      display: inline-block;
                      width: 120px;
                    }
                    
                    .entry { 
                      margin-bottom: 25px;
                      page-break-inside: avoid;
                      border-left: 3px solid #e5e7eb;
                      padding-left: 20px;
                    }
                    
                    .entry-header { 
                      font-weight: bold;
                      font-size: 18px;
                      color: #1e40af;
                      margin-bottom: 5px;
                    }
                    
                    .entry-meta { 
                      color: #666;
                      font-size: 14px;
                      margin-bottom: 10px;
                    }
                    
                    .entry-company {
                      font-weight: 600;
                      color: #374151;
                    }
                    
                    .entry-dates {
                      color: #6b7280;
                      font-style: italic;
                    }
                    
                    .entry-type {
                      display: inline-block;
                      background: #dbeafe;
                      color: #1e40af;
                      padding: 2px 8px;
                      border-radius: 4px;
                      font-size: 12px;
                      margin-left: 8px;
                    }
                    
                    .description { 
                      margin-top: 10px;
                      line-height: 1.7;
                      color: #4b5563;
                      font-size: 14px;
                    }
                    
                    .footer {
                      margin-top: 40px;
                      padding-top: 20px;
                      border-top: 2px solid #e5e7eb;
                      text-align: center;
                      color: #9ca3af;
                      font-size: 12px;
                    }
                    
                    @media print {
                      body {
                        padding: 0;
                      }
                      
                      .no-print {
                        display: none;
                      }
                    }
                  </style>
                </head>
                <body>
                  <div class="container">
                    <h1>${personalInfo.fullName}</h1>
                    
                    <div class="personal-info">
                      <p><strong>Email:</strong> ${personalInfo.email}</p>
                      <p><strong>Phone:</strong> ${personalInfo.phone}</p>
                      <p><strong>Date of Birth:</strong> ${personalInfo.dateOfBirth} (Age: ${personalInfo.currentAge})</p>
                    </div>
                    
                    <h2>Complete Employment History (Age 16 to Present)</h2>
            `;

            sortedEntries.forEach(entry => {
              const typeLabel = entry.type !== 'employment' 
                ? `<span class="entry-type">${entry.type.charAt(0).toUpperCase() + entry.type.slice(1)}</span>`
                : '';
              
              content += `
                <div class="entry">
                  <div class="entry-header">${entry.title} ${typeLabel}</div>
                  <div class="entry-meta">
                    <span class="entry-company">${entry.company}</span>${entry.location ? `, ${entry.location}` : ''}<br>
                    <span class="entry-dates">${entry.startDate} - ${entry.isCurrent ? 'Present' : entry.endDate}</span>
                  </div>
                  ${entry.description ? `<div class="description">${entry.description}</div>` : ''}
                </div>
              `;
            });

            const today = new Date().toLocaleDateString('en-GB', { 
              year: 'numeric', 
              month: 'long', 
              day: 'numeric' 
            });

            content += `
                    <div class="footer">
                      <p>Curriculum Vitae - Generated on ${today}</p>
                      <p>Complete continuous employment history with no gaps from age 16 to present</p>
                    </div>
                  </div>
                  
                  <div class="no-print" style="position: fixed; top: 20px; right: 20px; background: white; padding: 15px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                    <button onclick="window.print()" style="background: #2563eb; color: white; border: none; padding: 12px 24px; border-radius: 6px; cursor: pointer; font-size: 16px; font-weight: bold; margin-bottom: 10px; width: 100%;">
                      Save as PDF / Print
                    </button>
                    <button onclick="window.close()" style="background: #6b7280; color: white; border: none; padding: 12px 24px; border-radius: 6px; cursor: pointer; font-size: 16px; width: 100%;">
                      Close
                    </button>
                  </div>
                </body>
              </html>
            `;

            printWindow.document.write(content);
            printWindow.document.close();
          };

          useEffect(() => {
            if (entries.length > 0) {
              checkForGaps();
            }
          }, [entries, personalInfo.dateOfBirth]);

          return (
            <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6">
              <div className="max-w-4xl mx-auto bg-white rounded-lg shadow-xl p-8">
                <h1 className="text-3xl font-bold text-blue-900 mb-2">Continuous Employment CV Builder</h1>
                <p className="text-gray-600 mb-8">Track your complete work history from age 16 with no gaps</p>

                <div className="mb-8 p-6 bg-blue-50 rounded-lg">
                  <h2 className="text-xl font-semibold text-blue-900 mb-4">Personal Information</h2>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <input
                      type="text"
                      placeholder="Full Name"
                      value={personalInfo.fullName}
                      onChange={(e) => setPersonalInfo({...personalInfo, fullName: e.target.value})}
                      className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    />
                    <input
                      type="email"
                      placeholder="Email"
                      value={personalInfo.email}
                      onChange={(e) => setPersonalInfo({...personalInfo, email: e.target.value})}
                      className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    />
                    <input
                      type="tel"
                      placeholder="Phone"
                      value={personalInfo.phone}
                      onChange={(e) => setPersonalInfo({...personalInfo, phone: e.target.value})}
                      className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    />
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Date of Birth</label>
                      <input
                        type="date"
                        value={personalInfo.dateOfBirth}
                        onChange={(e) => handleDOBChange(e.target.value)}
                        className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent w-full"
                      />
                      {personalInfo.currentAge && (
                        <p className="text-sm text-gray-600 mt-1">Current Age: {personalInfo.currentAge}</p>
                      )}
                    </div>
                  </div>
                </div>

                {gaps.length > 0 && (
                  <div className="mb-6 p-4 bg-red-50 border border-red-200 rounded-lg">
                    <div className="flex items-start">
                      <AlertCircle className="text-red-600 mr-3 mt-1" size={20} />
                      <div>
                        <h3 className="font-semibold text-red-900 mb-2">Employment Gaps Detected</h3>
                        {gaps.map((gap, index) => (
                          <p key={index} className="text-red-800 text-sm mb-1">
                            Gap from {gap.start} to {gap.end} ({gap.days} days)
                          </p>
                        ))}
                        <p className="text-red-700 text-sm mt-2">
                          Please add entries to cover these periods (employment, education, unemployment, travel, etc.)
                        </p>
                      </div>
                    </div>
                  </div>
                )}

                <div className="mb-6">
                  <div className="flex justify-between items-center mb-4">
                    <h2 className="text-xl font-semibold text-blue-900">Employment History</h2>
                    <button
                      onClick={addEntry}
                      className="flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition"
                    >
                      <Plus size={20} />
                      Add Entry
                    </button>
                  </div>

                  {entries.map((entry) => (
                    <div key={entry.id} className="mb-6 p-6 bg-gray-50 rounded-lg border border-gray-200">
                      <div className="flex justify-between items-start mb-4">
                        <select
                          value={entry.type}
                          onChange={(e) => updateEntry(entry.id, 'type', e.target.value)}
                          className="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                        >
                          <option value="employment">Employment</option>
                          <option value="education">Education</option>
                          <option value="unemployment">Unemployment</option>
                          <option value="gap year">Gap Year</option>
                          <option value="travel">Travel</option>
                          <option value="self-employed">Self-Employed</option>
                          <option value="volunteer">Volunteer Work</option>
                        </select>
                        <button
                          onClick={() => deleteEntry(entry.id)}
                          className="text-red-600 hover:text-red-800"
                        >
                          <Trash2 size={20} />
                        </button>
                      </div>

                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <input
                          type="text"
                          placeholder="Job Title / Activity"
                          value={entry.title}
                          onChange={(e) => updateEntry(entry.id, 'title', e.target.value)}
                          className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                        />
                        <input
                          type="text"
                          placeholder="Company / Institution"
                          value={entry.company}
                          onChange={(e) => updateEntry(entry.id, 'company', e.target.value)}
                          className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                        />
                        <input
                          type="text"
                          placeholder="Location"
                          value={entry.location}
                          onChange={(e) => updateEntry(entry.id, 'location', e.target.value)}
                          className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                        />
                      </div>

                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                          <label className="block text-sm text-gray-700 mb-1">Start Date</label>
                          <input
                            type="date"
                            value={entry.startDate}
                            onChange={(e) => updateEntry(entry.id, 'startDate', e.target.value)}
                            className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 w-full"
                          />
                        </div>
                        <div>
                          <label className="block text-sm text-gray-700 mb-1">End Date</label>
                          <div className="flex items-center gap-2">
                            <input
                              type="date"
                              value={entry.endDate}
                              onChange={(e) => updateEntry(entry.id, 'endDate', e.target.value)}
                              disabled={entry.isCurrent}
                              className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 flex-1 disabled:bg-gray-100"
                            />
                            <label className="flex items-center gap-2 text-sm">
                              <input
                                type="checkbox"
                                checked={entry.isCurrent}
                                onChange={(e) => updateEntry(entry.id, 'isCurrent', e.target.checked)}
                                className="w-4 h-4"
                              />
                              Current
                            </label>
                          </div>
                        </div>
                      </div>

                      <textarea
                        placeholder="Description of responsibilities, achievements, or activities..."
                        value={entry.description}
                        onChange={(e) => updateEntry(entry.id, 'description', e.target.value)}
                        rows="3"
                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                      />
                    </div>
                  ))}
                </div>

                <div className="flex gap-4">
                  <button
                    onClick={generatePDF}
                    className="flex items-center gap-2 bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition font-semibold"
                  >
                    <Download size={20} />
                    Download CV
                  </button>
                  <button
                    onClick={checkForGaps}
                    className="flex items-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition font-semibold"
                  >
                    Check for Gaps
                  </button>
                </div>

                {gaps.length === 0 && entries.length > 0 && personalInfo.dateOfBirth && (
                  <div className="mt-4 p-4 bg-green-50 border border-green-200 rounded-lg">
                    <p className="text-green-800 font-semibold">✓ No gaps detected! Your employment history is complete.</p>
                  </div>
                )}
              </div>
            </div>
          );
        }

        ReactDOM.render(<CVBuilder />, document.getElementById('root'));
    </script>
</body>
</html>
